<div class="container">
    <div class="selfs">
        <div class="no-self" *ngIf="vehicleCares.length === 0">
            <p>{{validations.noVehicleCaresFound}}</p>
        </div>
        <div class="self" *ngFor="let vehicleCare of pagedVehicleCares">
            <div *ngIf="vehicleCare.name">
                <span>{{menu.for}}: {{vehicleCare.name}}</span>
                <span class="manipulations">
                    <a class="button" (click)="edit(vehicleCare)">{{menu.edit}}</a>
                    <a class="button" (click)="remove(vehicleCare)">{{menu.delete}}</a>
                </span>
            </div>
            <div *ngIf="vehicleCare.startDate">
                <span>{{menu.startDate}}:</span> {{vehicleCare.startDate}}
            </div>
            <div *ngIf="vehicleCare.endDate">
                <span>{{menu.endDate}}:</span> {{vehicleCare.endDate}}
            </div>
            <div *ngIf="vehicleCare.paidEndDate">
                <span>{{menu.paidEndDate}}:</span> {{vehicleCare.paidEndDate}}
            </div>
            <div *ngIf="vehicleCare.reminder">
                <span>{{menu.reminder}}:</span> {{vehicleCare.reminder}}
            </div>
            <div *ngIf="vehicleCare.price">
                <span>{{menu.price}}:</span> {{vehicleCare.price}}
            </div>
            <div *ngIf="vehicleCare.notes">
                <span>{{menu.notes}}:</span> {{vehicleCare.notes}}
            </div>
            <div *ngIf="vehicleCare.company?.name">{{company.label}}</div>
            <div *ngIf="vehicleCare.company?.name">
                <span>{{company.name}}:</span> {{vehicleCare.company?.name}}
            </div>
            <div *ngIf="vehicleCare.company?.phoneNumber">
                <span>{{company.phoneNumber}}:</span> {{vehicleCare.company?.phoneNumber}}
            </div>
            <div *ngIf="vehicleCare.company?.email">
                <span>{{company.email}}:</span> {{vehicleCare.company?.email}}
            </div>
            <div *ngIf="vehicleCare.company?.webSite">
                <span>{{company.webSite}}:</span> {{vehicleCare.company?.webSite}}
            </div>
            <div *ngIf="vehicleCare.company?.address">
                <span>{{company.address}}:</span> {{vehicleCare.company?.address}}
            </div>
        </div>

        <div class="back">
            <a class="button" (click)="back()">{{menu.back}}</a>
        </div>

        <app-page class="pager-view" [pager]="pager"></app-page>

    </div>
    <div class="creation">
        <div class="form">
            <form #veh="ngForm" (ngSubmit)="save(veh.value)">
                <div class="main">
                    <div class="form-raw">
                        <div>{{menu.for}} <span class="requiredInput">{{menu.required}}</span></div>
                        <div *ngIf="this.selectedLang === 'bg'">
                            <select name="name" [(ngModel)]="defaultVehicleCare.name" required>
                                <option *ngFor="let name of names.bg" [value]="name">{{name}}</option>
                            </select>
                        </div>
                        <div *ngIf="this.selectedLang === 'en'">
                            <select name="name" [(ngModel)]="defaultVehicleCare.name" required>
                                <option *ngFor="let name of names.en" [value]="name">{{name}}</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-raw">
                        <div>{{menu.startDate}}</div>
                        <input type="date" name="startDate" [(ngModel)]="defaultVehicleCare.startDate">
                    </div>

                    <div class="form-raw">
                        <div>{{menu.endDate}}</div>
                        <input type="date" name="endDate" [(ngModel)]="defaultVehicleCare.endDate">
                    </div>

                    <div class="form-raw">
                        <div>{{menu.paidEndDate}}</div>
                        <input type="date" name="paidEndDate" [(ngModel)]="defaultVehicleCare.paidEndDate">
                    </div>

                    <div class="form-raw">
                        <div>{{menu.reminder}}</div>
                        <input type="date" name="reminder" [(ngModel)]="defaultVehicleCare.reminder">
                    </div>

                    <div class="form-raw">
                        <div>{{menu.price}}</div>
                        <input type="number" name="price" [(ngModel)]="defaultVehicleCare.price">
                    </div>

                    <div class="form-raw">
                        <div>{{menu.notes}}</div>
                        <textarea type="text" name="notes" [(ngModel)]="defaultVehicleCare.notes"></textarea>
                    </div>

                    <div *ngIf="vehicleCares.length > 0">
                        <div *ngFor="let error of serverErrors">
                            <p>{{error.description}}</p>
                        </div>
                    </div>

                    <div>
                        <button [disabled]="veh.invalid || (
                        defaultVehicleCare.company.name === undefined && 
                        ((defaultVehicleCare.company.phoneNumber !== undefined && defaultVehicleCare.company.phoneNumber !== '') ||
                        (defaultVehicleCare.company.email !== undefined && defaultVehicleCare.company.email !== '') ||
                        (defaultVehicleCare.company.webSite !== undefined && defaultVehicleCare.company.webSite !== '') ||
                        (defaultVehicleCare.company.address !== undefined && defaultVehicleCare.company.address !== ''))
                        )">{{menu.save}}
                        </button>
                    </div>
                </div>
                <div class="company">
                    <div class="form-raw">
                        <div>{{company.label}}</div>
                        <div>{{company.name}} 
                            <span *ngIf="
                        ((defaultVehicleCare.company.phoneNumber !== undefined && defaultVehicleCare.company.phoneNumber !== '') ||
                        (defaultVehicleCare.company.email !== undefined && defaultVehicleCare.company.email !== '') ||
                        (defaultVehicleCare.company.webSite !== undefined && defaultVehicleCare.company.webSite !== '') ||
                        (defaultVehicleCare.company.address !== undefined && defaultVehicleCare.company.address !== ''))
                            " class="requiredInput">{{menu.required}}</span>
                        </div>
                        <div *ngIf="this.selectedLang === 'bg'">
                            <select name="name" [(ngModel)]="defaultVehicleCare.company.name" ngModelGroup="company">
                                <option *ngFor="let companyName of companyNames.vehicle.bg" [value]="companyName">
                                    {{companyName}}</option>
                            </select>
                        </div>
                        <div *ngIf="this.selectedLang === 'en'">
                            <select name="name" [(ngModel)]="defaultVehicleCare.company.name" ngModelGroup="company">
                                <option *ngFor="let companyName of companyNames.vehicle.en" [value]="companyName">
                                    {{companyName}}</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-raw">
                        <div>{{company.phoneNumber}}</div>
                        <input #phoneNumberInput="ngModel" type="text" name="phoneNumber" [(ngModel)]="defaultVehicleCare.company.phoneNumber" ngModelGroup="company">
                        <p class="validation" *ngIf="phoneNumberInput.touched && 
                        defaultVehicleCare.company.name === undefined && 
                        defaultVehicleCare.company.phoneNumber != '' &&
                        defaultVehicleCare.company.phoneNumber != undefined">
                            {{validations.companyNameRequired}}</p>
                    </div>

                    <div class="form-raw">
                        <div>{{company.email}}</div>
                        <input #emailInput="ngModel" type="text" name="email" [(ngModel)]="defaultVehicleCare.company.email" ngModelGroup="company" email>
                        <p class="validation" *ngIf="emailInput.touched && 
                        emailInput?.errors?.email">
                            {{validations.invalidEmail}}</p>
                        <p class="validation" *ngIf="emailInput.touched && 
                        defaultVehicleCare.company.name === undefined && 
                        defaultVehicleCare.company.email != '' &&
                        defaultVehicleCare.company.email != undefined">
                            {{validations.companyNameRequired}}</p>
                    </div>

                    <div class="form-raw">
                        <div>{{company.webSite}}</div>
                        <input #webSiteInput="ngModel" type="text" name="webSite" [(ngModel)]="defaultVehicleCare.company.webSite" ngModelGroup="company">
                        <p class="validation" *ngIf="webSiteInput.touched && 
                        defaultVehicleCare.company.name === undefined && 
                        defaultVehicleCare.company.webSite != '' &&
                        defaultVehicleCare.company.webSite != undefined">
                            {{validations.companyNameRequired}}</p>
                    </div>

                    <div class="form-raw">
                        <div>{{company.address}}</div>
                        <input #addressInput="ngModel" type="text" name="address" [(ngModel)]="defaultVehicleCare.company.address" ngModelGroup="company">
                        <p class="validation" *ngIf="addressInput.touched && 
                        defaultVehicleCare.company.name === undefined && 
                        defaultVehicleCare.company.address != '' &&
                        defaultVehicleCare.company.address != undefined">
                            {{validations.companyNameRequired}}</p>
                    </div>

                </div>
            </form>
        </div>
    </div>
</div>